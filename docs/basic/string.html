

<!doctype html>


<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-TW">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>字串 &#8212; Rust 程式設計從頭開始 1.0.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/bizstyle.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="next" title="所有權" href="../advance/ownership.html" />
    <link rel="prev" title="模組和套件" href="module_package.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!--[if lt IE 9]>
    <script type="text/javascript" src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../advance/ownership.html" title="所有權"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="module_package.html" title="模組和套件"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Rust 程式設計從頭開始 1.0.0 documentation</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">字串</a><ul>
<li><a class="reference internal" href="#rust">Rust 字串</a></li>
<li><a class="reference internal" href="#id2">對字串進行索引</a></li>
<li><a class="reference internal" href="#id3">字串相接</a></li>
<li><a class="reference internal" href="#id4">格式化字串</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="module_package.html"
                        title="previous chapter">模組和套件</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="../advance/ownership.html"
                        title="next chapter">所有權</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/basic/string.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="id1">
<h1>字串<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<div class="section" id="rust">
<h2>Rust 字串<a class="headerlink" href="#rust" title="Permalink to this headline">¶</a></h2>
<p>Rust 的字串有以下兩種：</p>
<ul class="simple">
<li>String 類別是以 UTF8 編碼、可伸縮的字串</li>
<li>str 是基礎型別，通常是使用 <code class="docutils literal"><span class="pre">&amp;str</span></code>，即指向 str 的參考</li>
</ul>
<p>另外，Rust 還有字元 (char) 型別，同樣也是以 UTF8 編碼。</p>
<p>建立字串常數時，預設型別是 <code class="docutils literal"><span class="pre">&amp;str</span></code>，即指向 str 的參考，但是，若想要使用 String 類別的方法時，可以轉為 String 物件。</p>
<div class="highlight-rust"><div class="highlight"><pre><span></span><span class="k">fn</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="c1">// Reference to str</span>
<span class="w">   </span><span class="kd">let</span><span class="w"> </span><span class="n">s</span><span class="o">:</span><span class="w"> </span><span class="o">&amp;</span><span class="kt">str</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Hello&quot;</span><span class="p">;</span><span class="w"></span>

<span class="w">   </span><span class="c1">// String object</span>
<span class="w">   </span><span class="kd">let</span><span class="w"> </span><span class="n">s_obj</span><span class="o">:</span><span class="w"> </span><span class="nb">String</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">String</span><span class="o">::</span><span class="n">from</span><span class="p">(</span><span class="s">&quot;Hello&quot;</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="id2">
<h2>對字串進行索引<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>由於 Rust 字串為 UTF8 字串，其內部長度和字元數不同，不能直接對其進行索引。以下的範例是錯誤的：</p>
<div class="highlight-rust"><div class="highlight"><pre><span></span><span class="k">fn</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert_eq</span><span class="o">!</span><span class="p">(</span><span class="s">&quot;Hello&quot;</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="s">&quot;H&quot;</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>本例引發以下錯誤訊息：</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">error[E0277]: the trait bound `std::string::String: std::ops::Index&lt;{integer}&gt;` is not satisfied</span>
</pre></div>
</div>
<p>如果想要得到單一的字元，需用 <code class="docutils literal"><span class="pre">chars</span></code> 方法，會得到走訪字元的迭代器。</p>
<div class="highlight-rust"><div class="highlight"><pre><span></span><span class="k">fn</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert_eq</span><span class="o">!</span><span class="p">(</span><span class="s">&quot;你好，麥可&quot;</span><span class="p">.</span><span class="n">chars</span><span class="p">().</span><span class="n">nth</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">unwrap</span><span class="p">(),</span><span class="w"> </span><span class="sc">&#39;好&#39;</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>由於 Rust 的字元是以 UTF8 編碼，即使用非英文的字元也可以。</p>
</div>
<div class="section" id="id3">
<h2>字串相接<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>字串間可以用 <code class="docutils literal"><span class="pre">+</span></code> 相接，相接的方式是以 String 物件接 <code class="docutils literal"><span class="pre">&amp;str</span></code>，如下：</p>
<div class="highlight-rust"><div class="highlight"><pre><span></span><span class="k">fn</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">assert_eq</span><span class="o">!</span><span class="p">(</span><span class="s">&quot;Hello &quot;</span><span class="p">.</span><span class="n">to_string</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;World&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Hello World&quot;</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>如果要將兩個 String 物件相接，則要將 String 物件取參考，轉為 <code class="docutils literal"><span class="pre">&amp;str</span></code>，如下：</p>
<div class="highlight-rust"><div class="highlight"><pre><span></span><span class="k">fn</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">s1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">String</span><span class="o">::</span><span class="n">from</span><span class="p">(</span><span class="s">&quot;Hello &quot;</span><span class="p">);</span><span class="w"></span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="n">s2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">String</span><span class="o">::</span><span class="n">from</span><span class="p">(</span><span class="s">&quot;World&quot;</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="n">assert_eq</span><span class="o">!</span><span class="p">(</span><span class="n">s1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="o">&amp;</span><span class="n">s2</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Hello World&quot;</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
<div class="section" id="id4">
<h2>格式化字串<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>Rust 提供數個格式化字串的巨集，包括：</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">format!</span></code>：將格式化字串轉為 String 物件</li>
<li><code class="docutils literal"><span class="pre">println!</span></code>：將格式化字串印到終端機，附帶換行字元</li>
<li><code class="docutils literal"><span class="pre">print!</span></code>：將格式化字串印到終端機，但不附加換行字元</li>
<li><code class="docutils literal"><span class="pre">writeln!</span></code>：將格式化字串寫入特定的 buffer 物件，附帶換行字元</li>
<li><code class="docutils literal"><span class="pre">write!</span></code>：將格式化字串寫入特定的 buffer 物件，但不附帶換行字元</li>
</ul>
<p>以下實例將錯誤訊息輸出到標準錯誤 (standard error)：</p>
<div class="highlight-rust"><div class="highlight"><pre><span></span><span class="kn">use</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">io</span><span class="o">::</span><span class="n">Write</span><span class="p">;</span><span class="w"></span>

<span class="k">fn</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="n">writeln</span><span class="o">!</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span><span class="w"> </span><span class="n">std</span><span class="o">::</span><span class="n">io</span><span class="o">::</span><span class="n">stderr</span><span class="p">(),</span><span class="w"> </span><span class="s">&quot;Error message&quot;</span><span class="p">)</span><span class="w"></span>
<span class="w">        </span><span class="p">.</span><span class="n">expect</span><span class="p">(</span><span class="s">&quot;Failed to print to stderr&quot;</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<p>以下實例輸出不同的格式化字串：</p>
<div class="highlight-rust"><div class="highlight"><pre><span></span><span class="k">fn</span><span class="w"> </span><span class="n">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// Hexadeicmal number</span>
<span class="w">    </span><span class="n">assert_eq</span><span class="o">!</span><span class="p">(</span><span class="n">format</span><span class="o">!</span><span class="p">(</span><span class="s">&quot;0x{:X}&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">255</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;0xFF&quot;</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Octal number</span>
<span class="w">    </span><span class="n">assert_eq</span><span class="o">!</span><span class="p">(</span><span class="n">format</span><span class="o">!</span><span class="p">(</span><span class="s">&quot;0o{:o}&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">127</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;0o177&quot;</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Decimal with specific precision</span>
<span class="w">    </span><span class="n">assert_eq</span><span class="o">!</span><span class="p">(</span><span class="n">format</span><span class="o">!</span><span class="p">(</span><span class="s">&quot;{:.2}&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">3.14159</span><span class="p">),</span><span class="w"> </span><span class="s">&quot;3.14&quot;</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Formatted string for debug purpose</span>
<span class="w">    </span><span class="n">assert_eq</span><span class="o">!</span><span class="p">(</span><span class="n">format</span><span class="o">!</span><span class="p">(</span><span class="s">&quot;{:?}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">vec</span><span class="o">!</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">]),</span><span class="w"> </span><span class="s">&quot;[1, 2, 3]&quot;</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Formatted string with specific position</span>
<span class="w">    </span><span class="n">assert_eq</span><span class="o">!</span><span class="p">(</span><span class="n">format</span><span class="o">!</span><span class="p">(</span><span class="s">&quot;{0}, this is {1}. {1}, this is {0}&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Alice&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Bob&quot;</span><span class="p">),</span><span class="w"></span>
<span class="w">               </span><span class="s">&quot;Alice, this is Bob. Bob, this is Alice&quot;</span><span class="p">);</span><span class="w"></span>

<span class="w">    </span><span class="c1">// Formatted string with specific name</span>
<span class="w">    </span><span class="n">assert_eq</span><span class="o">!</span><span class="p">(</span><span class="n">format</span><span class="o">!</span><span class="p">(</span><span class="s">&quot;{subject} {verb} {object}&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;the lazy dog&quot;</span><span class="p">,</span><span class="w"></span>
<span class="w">                       </span><span class="n">verb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;jumps over&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">subject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;The swift fox&quot;</span><span class="p">),</span><span class="w"></span>
<span class="w">               </span><span class="s">&quot;The swift fox jumps over the lazy dog&quot;</span><span class="p">);</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../advance/ownership.html" title="所有權"
             >next</a></li>
        <li class="right" >
          <a href="module_package.html" title="模組和套件"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Rust 程式設計從頭開始 1.0.0 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; <a href="../copyright.html">Copyright</a> Michael Chen, 2017.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.1.
    </div>
  </body>
</html>